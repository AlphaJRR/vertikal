import React, { useState, useRef, useEffect } from 'react';
import { 
  View, Text, ScrollView, TouchableOpacity, StyleSheet, 
  Dimensions, StatusBar, Modal, FlatList
} from 'react-native';
import { SafeAreaProvider, SafeAreaView } from 'react-native-safe-area-context';
import { NavigationContainer } from '@react-navigation/native';
import { createBottomTabNavigator, BottomTabScreenProps } from '@react-navigation/bottom-tabs';
import { Video, ResizeMode } from 'expo-av'; 
import { LinearGradient } from 'expo-linear-gradient';
import { Image } from 'expo-image';
import Animated, { 
  useSharedValue, 
  useAnimatedStyle, 
  withRepeat, 
  withTiming, 
  Easing 
} from 'react-native-reanimated';
import { Home, Tv, Smartphone, Clapperboard, User, MessageSquare, Plus, Play, Globe, X } from 'lucide-react-native';
import { CREATORS_FULL, PROJECTS_FULL } from './data'; // Fallback data
import { ErrorBoundary } from './components/ui/ErrorBoundary';
import { QueryProvider } from './providers/QueryProvider';
import { LoadingSpinner } from './components/ui/LoadingSpinner';
import { ErrorState } from './components/ui/ErrorState';
import { analytics } from './services/analytics';
import { errorTracking } from './services/errorTracking';
import { useCreators } from './hooks/useCreators';
import { useProjects } from './hooks/useProjects';
import { getProjectsWithFallback } from './utils/dataTransform';

// --- TYPES ---
type RootTabParamList = {
  HOME: undefined;
  SERIES: undefined;
  SHORTS: undefined;
  TRAILERS: undefined;
  PROFILE: undefined;
};

type HomeScreenProps = BottomTabScreenProps<RootTabParamList, 'HOME'>;
type ProfileScreenProps = BottomTabScreenProps<RootTabParamList, 'PROFILE'>;

// --- CONSTANTS ---
const { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');

const COLORS = {
  black: '#000000',
  gold: '#FFD700',
  surface: '#121212',
  text: '#FFFFFF',
  primary: '#3B82F6',
  purple: '#9333EA',
};

const LOGO_URL = "https://www.dropbox.com/scl/fi/7deqzj0fkqr4my6cgi9ik/Image-2.jpg?rlkey=szrgy5uqh14m7k8k3lvvu5fic&st=a6f8yfx0&raw=1";

// --- COMPONENTS ---

const Header = ({ onOpenMessages }: { onOpenMessages: () => void }) => {
  const [logoError, setLogoError] = useState(false);
  
  return (
    <View style={styles.header}>
      <View style={styles.logoRow}>
        <Image 
          source={logoError ? require('./assets/icon.png') : { uri: LOGO_URL }}
          onError={() => setLogoError(true)}
          style={styles.logoImage}
          cachePolicy="memory-disk"
          contentFit="cover"
          transition={200}
        />
        <Text style={styles.logoText}>VERTIKAL</Text>
      </View>
      <View style={styles.headerIcons}>
        <View style={styles.coinPill}><Text style={styles.coinText}>$ 150</Text></View>
        <TouchableOpacity onPress={onOpenMessages}>
          <MessageSquare color="white" size={24} />
          <View style={styles.redDot} />
        </TouchableOpacity>
      </View>
    </View>
  );
};

const FloatingComment = ({ text, top, duration }: { text: string, top: string, duration: number }) => {
  const translateX = useSharedValue(SCREEN_WIDTH);

  useEffect(() => {
    translateX.value = SCREEN_WIDTH;
    translateX.value = withRepeat(
      withTiming(-SCREEN_WIDTH, { 
        duration, 
        easing: Easing.linear 
      }),
      -1, // infinite repeat
      false
    );
  }, [duration]);

  const animatedStyle = useAnimatedStyle(() => ({
    transform: [{ translateX: translateX.value }],
  }));

  return (
    <Animated.View 
      style={[
        styles.danmakuBubble, 
        { top: top as any }, 
        animatedStyle
      ]}
    >
      <Text style={styles.danmakuText}>{text}</Text>
    </Animated.View>
  );
};

const DanmakuOverlay = ({ active }: { active: boolean }) => {
  const [comments] = useState([
    { id: 1, text: "This lighting is insane üî•", top: '15%', speed: 4000 },
    { id: 2, text: "Wait for the drop... üé•", top: '35%', speed: 6000 },
    { id: 3, text: "Chicago represent! üèôÔ∏è", top: '55%', speed: 5000 },
    { id: 4, text: "That transition though ü§Ø", top: '75%', speed: 4500 },
    { id: 5, text: "VERTIKAL is the future üöÄ", top: '25%', speed: 7000 },
  ]);

  if (!active) return null;

  return (
    <View style={styles.danmakuContainer} pointerEvents="none">
      {comments.map((c) => (
        <FloatingComment key={c.id} text={c.text} top={c.top} duration={c.speed} />
      ))}
    </View>
  );
};

const MessagingModal = ({ visible, onClose }: { visible: boolean, onClose: () => void }) => {
  const [imageErrors, setImageErrors] = useState<Record<string, boolean>>({});
  
  return (
    <Modal visible={visible} animationType="slide" presentationStyle="pageSheet">
      <View style={styles.msgContainer}>
        <View style={styles.msgHeader}>
          <Text style={styles.msgTitle}>Messages (3)</Text>
          <TouchableOpacity onPress={onClose}><X color="white" size={24} /></TouchableOpacity>
        </View>
        <ScrollView style={styles.msgList}>
          {CREATORS_FULL.slice(0, 5).map((user) => (
            <TouchableOpacity key={user.id} style={styles.msgRow}>
              <Image 
                source={{ uri: user.avatar }} 
                style={styles.msgAvatar}
                cachePolicy="memory-disk"
                contentFit="cover"
                onError={() => setImageErrors(prev => ({ ...prev, [user.id]: true }))}
              />
              <View style={styles.msgContent}>
                <View style={styles.msgTop}>
                  <Text style={styles.msgName}>{user.name}</Text>
                  <Text style={styles.msgTime}>2m</Text>
                </View>
                <Text style={styles.msgPreview} numberOfLines={1}>
                  Yo, are you free for the shoot next week?
                </Text>
              </View>
            </TouchableOpacity>
          ))}
        </ScrollView>
      </View>
    </Modal>
  );
};

const SubscriptionModal = ({ visible, onClose }: { visible: boolean, onClose: () => void }) => (
  <Modal visible={visible} transparent animationType="slide">
    <View style={styles.modalOverlay}>
      <View style={styles.modalContent}>
        <View style={styles.modalHeader}>
          <Text style={styles.modalTitle}>Vertikal Premium</Text>
          <TouchableOpacity onPress={onClose}><X color="#666" size={24} /></TouchableOpacity>
        </View>
        <LinearGradient colors={['#1e3a8a', '#581c87']} style={styles.subCard}>
          <View style={styles.subIcon}><Text style={styles.subIconText}>V+</Text></View>
          <View>
            <Text style={styles.subCardTitle}>All Access Pass</Text>
            <Text style={styles.subCardDesc}>Unlock All 12 Founding Networks</Text>
          </View>
        </LinearGradient>
        <TouchableOpacity style={styles.subButton}>
          <Text style={styles.subButtonText}>Subscribe $4.99/mo</Text>
        </TouchableOpacity>
      </View>
    </View>
  </Modal>
);

// --- SCREENS ---

const HomeScreen = ({ navigation }: HomeScreenProps) => {
  const [vibeOn, setVibeOn] = useState(false);
  const [msgVisible, setMsgVisible] = useState(false);
  const [imageErrors, setImageErrors] = useState<Record<string, boolean>>({});
  const video = useRef<Video>(null);

  // API Hooks - Fetch data from backend
  const { 
    data: creatorsData = [], 
    isLoading: creatorsLoading, 
    error: creatorsError,
    refetch: refetchCreators 
  } = useCreators();

  const { 
    data: projectsData = [], 
    isLoading: projectsLoading, 
    error: projectsError,
    refetch: refetchProjects 
  } = useProjects();

  // Fallback to mock data if API fails (for development)
  const creators = creatorsData.length > 0 ? creatorsData : CREATORS_FULL;
  const projects = getProjectsWithFallback(projectsData);

  // Video cleanup on unmount
  useEffect(() => {
    return () => {
      video.current?.pauseAsync().catch(() => {});
      video.current?.unloadAsync().catch(() => {});
    };
  }, []);

  // Track screen view
  useEffect(() => {
    analytics.screen('Home');
  }, []);

  const creatorData = [
    { id: 'add', type: 'add' as const },
    ...creators.map(c => ({ 
      id: c.id, 
      type: 'creator' as const, 
      creator: {
        id: c.id,
        name: c.name,
        avatar: c.avatar,
        type: c.type,
      }
    }))
  ];

  return (
    <SafeAreaView style={styles.container} edges={['top']}>
      <StatusBar barStyle="light-content" />
      <MessagingModal visible={msgVisible} onClose={() => setMsgVisible(false)} />
      <Header onOpenMessages={() => setMsgVisible(true)} />
      <ScrollView 
        contentContainerStyle={{ paddingBottom: 100 }} 
        showsVerticalScrollIndicator={false}
      >
        {/* HERO SECTION */}
        <View style={styles.heroContainer}>
          <Video
            ref={video}
            style={styles.video}
            source={{ uri: 'https://assets.mixkit.co/videos/preview/mixkit-athlete-working-out-with-heavy-ropes-in-the-gym-43750-large.mp4' }}
            resizeMode={ResizeMode.COVER}
            isLooping
            shouldPlay
            isMuted
          />
          <LinearGradient colors={['transparent', 'rgba(0,0,0,0.6)', 'black']} style={styles.gradient} />
          <DanmakuOverlay active={vibeOn} />
          
          {/* Vibe Toggle */}
          <TouchableOpacity 
            style={[styles.vibeButton, vibeOn && styles.vibeButtonActive]} 
            onPress={() => setVibeOn(!vibeOn)}
          >
            <Text style={styles.vibeText}>{vibeOn ? 'VIBE ON' : 'VIBE OFF'}</Text>
          </TouchableOpacity>

          <View style={styles.heroContent}>
            <Text style={styles.featuredTag}>‚òÖ FEATURED PREMIERE</Text>
            <Text style={styles.heroTitle}>BEYOND THE BASES</Text>
            <View style={styles.heroMeta}>
              <Text style={styles.matchTag}>98% Match</Text>
              <Text style={styles.genreTag}>Sports Docu</Text>
            </View>
            
            <View style={styles.heroActions}>
              <TouchableOpacity style={styles.playButton}>
                <Play fill="black" size={16} color="black"/>
                <Text style={styles.playText}>PLAY</Text>
              </TouchableOpacity>
              <TouchableOpacity style={styles.addButton}>
                <Plus size={24} color="white" />
              </TouchableOpacity>
            </View>

            {/* CREATOR ROSTER - Optimized FlatList */}
            <View style={{ height: 90 }}>
              {creatorsLoading ? (
                <LoadingSpinner size="small" />
              ) : creatorsError ? (
                <ErrorState 
                  message="Failed to load creators"
                  onRetry={() => refetchCreators()}
                  retryLabel="RETRY"
                />
              ) : (
                <FlatList
                  horizontal
                  showsHorizontalScrollIndicator={false}
                  data={creatorData}
                  keyExtractor={(item) => item.id}
                  renderItem={({ item }) => {
                    if (item.type === 'add') {
                      return (
                        <View style={styles.addCreator}>
                          <View style={styles.addCreatorCircle}>
                            <Plus size={20} color="#666"/>
                          </View>
                          <Text style={styles.creatorName}>Add</Text>
                        </View>
                      );
                    }
                    const c = item.creator!;
                    return (
                      <TouchableOpacity 
                        key={c.id} 
                        style={styles.creatorItem} 
                        onPress={() => navigation.navigate('PROFILE')}
                      >
                        <Image 
                          source={{ uri: c.avatar }} 
                          style={[styles.avatar, c.type === 'network' ? styles.netBorder : styles.creBorder]}
                          cachePolicy="memory-disk"
                          contentFit="cover"
                          onError={() => setImageErrors(prev => ({ ...prev, [c.id]: true }))}
                        />
                        <Text style={styles.creatorName} numberOfLines={1}>
                          {c.name.split(' ')[0]}
                        </Text>
                      </TouchableOpacity>
                    );
                  }}
                  initialNumToRender={10}
                  maxToRenderPerBatch={5}
                  windowSize={5}
                  removeClippedSubviews={true}
                  getItemLayout={(_, index) => ({
                    length: 76,
                    offset: 76 * index,
                    index,
                  })}
                />
              )}
            </View>
          </View>
        </View>

        {/* CONTINUE WATCHING */}
        <View style={styles.section}>
          <View style={styles.sectionHeader}>
            <Text style={styles.sectionTitle}>Continue Watching</Text>
            <Text style={styles.seeAll}>See All</Text>
          </View>
          
          {projectsLoading ? (
            <LoadingSpinner message="Loading content..." />
          ) : projectsError ? (
            <ErrorState 
              message="Failed to load content"
              onRetry={() => refetchProjects()}
            />
          ) : projects.length === 0 ? (
            <View style={styles.emptyState}>
              <Text style={styles.emptyText}>No content available</Text>
            </View>
          ) : (
            <FlatList 
              horizontal
              showsHorizontalScrollIndicator={false}
              data={projects}
              keyExtractor={item => item.id}
              nestedScrollEnabled={true}
              renderItem={({ item }) => (
                <View style={styles.projectCard}>
                  <Image 
                    source={{ uri: item.coverImage }} 
                    style={styles.projectImg}
                    cachePolicy="memory-disk"
                    contentFit="cover"
                  />
                  <View style={styles.progressBarBg}>
                    <View style={[styles.progressBarFill, { width: '0%' }]} />
                  </View>
                  <Text style={styles.projectTitle}>{item.title}</Text>
                  <Text style={styles.projectSub}>{item.genre}</Text>
                </View>
              )}
            />
          )}
        </View>
      </ScrollView>
    </SafeAreaView>
  );
};

const ProfileScreen = ({ navigation }: ProfileScreenProps) => {
  const [subVisible, setSubVisible] = useState(false);
  const [avatarError, setAvatarError] = useState(false);
  
  return (
    <SafeAreaView style={styles.container}>
      <SubscriptionModal visible={subVisible} onClose={() => setSubVisible(false)} />
      <ScrollView>
        <View style={styles.profileHeader}>
          <View style={[styles.largeAvatarContainer, styles.netBorder]}>
            <Image 
              source={avatarError ? require('./assets/icon.png') : { uri: CREATORS_FULL[0].avatar }} 
              style={styles.largeAvatar}
              cachePolicy="memory-disk"
              contentFit="cover"
              onError={() => setAvatarError(true)}
            />
            <View style={styles.foundingBadge}>
              <Text style={styles.badgeText}>FOUNDING 50</Text>
            </View>
          </View>
          <Text style={styles.profileName}>Black Awesomeness</Text>
          <View style={styles.roleRow}>
            <Globe size={12} color="#888"/>
            <Text style={styles.roleText}>Production Network</Text>
          </View>
          
          <View style={styles.statsRow}>
            <View style={styles.stat}>
              <Text style={styles.statNum}>150k</Text>
              <Text style={styles.statLabel}>SUBS</Text>
            </View>
            <View style={styles.stat}>
              <Text style={styles.statNum}>12</Text>
              <Text style={styles.statLabel}>SERIES</Text>
            </View>
            <View style={styles.stat}>
              <Text style={[styles.statNum, {color: COLORS.gold}]}>2.5M</Text>
              <Text style={styles.statLabel}>VIEWS</Text>
            </View>
          </View>

          <TouchableOpacity style={styles.subButtonProfile} onPress={() => setSubVisible(true)}>
            <Text style={styles.subButtonTextBlack}>SUBSCRIBE $4.99</Text>
          </TouchableOpacity>
        </View>
      </ScrollView>
    </SafeAreaView>
  );
};

// Placeholder screens
const SeriesScreen = () => (
  <View style={styles.center}>
    <Text style={{color:'white'}}>Series Content</Text>
  </View>
);

const ShortsScreen = () => (
  <View style={styles.center}>
    <Text style={{color:'white'}}>Shorts Content</Text>
  </View>
);

const TrailersScreen = () => (
  <View style={styles.center}>
    <Text style={{color:'white'}}>Trailers Content</Text>
  </View>
);

// --- NAVIGATION CONFIG ---

const Tab = createBottomTabNavigator<RootTabParamList>();

function AppContent() {
  return (
    <SafeAreaProvider>
      <NavigationContainer>
        <Tab.Navigator
          screenOptions={{
            headerShown: false,
            tabBarStyle: styles.tabBar,
            tabBarActiveTintColor: COLORS.text,
            tabBarInactiveTintColor: '#555',
            tabBarShowLabel: true,
            tabBarLabelStyle: { fontSize: 10, fontWeight: 'bold', marginTop: -5 }
          }}
        >
          <Tab.Screen 
            name="HOME" 
            component={HomeScreen} 
            options={{ tabBarIcon: ({color}) => <Home color={color} size={24} /> }} 
          />
          <Tab.Screen 
            name="SERIES" 
            component={SeriesScreen} 
            options={{ tabBarIcon: ({color}) => <Tv color={color} size={24} /> }} 
          />
          <Tab.Screen 
            name="SHORTS" 
            component={ShortsScreen} 
            options={{ tabBarIcon: ({color}) => <Smartphone color={color} size={24} /> }} 
          />
          <Tab.Screen 
            name="TRAILERS" 
            component={TrailersScreen} 
            options={{ tabBarIcon: ({color}) => <Clapperboard color={color} size={24} /> }} 
          />
          <Tab.Screen 
            name="PROFILE" 
            component={ProfileScreen} 
            options={{ tabBarIcon: ({color}) => <User color={color} size={24} /> }} 
          />
        </Tab.Navigator>
      </NavigationContainer>
    </SafeAreaProvider>
  );
}

export default function App() {
  // Initialize analytics and error tracking
  React.useEffect(() => {
    errorTracking.initialize();
    analytics.track('App Launched', {
      platform: 'mobile',
      version: '1.0.0',
    });
  }, []);

  return (
    <ErrorBoundary>
      <QueryProvider>
        <AppContent />
      </QueryProvider>
    </ErrorBoundary>
  );
}

// --- STYLES ---
const styles = StyleSheet.create({
  container: { flex: 1, backgroundColor: COLORS.black },
  center: { flex: 1, justifyContent: 'center', alignItems: 'center', backgroundColor: COLORS.black },
  
  // Header
  header: { flexDirection: 'row', justifyContent: 'space-between', padding: 16, position: 'absolute', top: 40, left: 0, right: 0, zIndex: 50 },
  logoRow: { flexDirection: 'row', alignItems: 'center' },
  logoImage: { width: 30, height: 30, borderRadius: 8, marginRight: 8 },
  logoText: { color: 'white', fontWeight: '900', fontSize: 18 },
  headerIcons: { flexDirection: 'row', alignItems: 'center' },
  coinPill: { backgroundColor: '#1A1A1A', paddingHorizontal: 12, paddingVertical: 6, borderRadius: 20, marginRight: 12, borderWidth: 1, borderColor: '#333' },
  coinText: { color: COLORS.gold, fontWeight: 'bold', fontSize: 12 },
  redDot: { width: 8, height: 8, backgroundColor: 'red', borderRadius: 4, position: 'absolute', top: -2, right: -2 },

  // Hero
  heroContainer: { height: SCREEN_HEIGHT * 0.75, width: '100%', position: 'relative' },
  video: { width: '100%', height: '100%' },
  gradient: { position: 'absolute', bottom: 0, left: 0, right: 0, height: 300 },
  
  vibeButton: { position: 'absolute', top: 100, right: 20, backgroundColor: 'rgba(0,0,0,0.5)', paddingHorizontal: 12, paddingVertical: 6, borderRadius: 20, borderWidth: 1, borderColor: 'rgba(255,255,255,0.2)' },
  vibeButtonActive: { backgroundColor: COLORS.primary, borderColor: COLORS.primary },
  vibeText: { color: 'white', fontSize: 10, fontWeight: '900' },

  danmakuContainer: { position: 'absolute', top: 0, left: 0, right: 0, bottom: 0, zIndex: 20 },
  danmakuBubble: { position: 'absolute', backgroundColor: 'rgba(0,0,0,0.7)', paddingHorizontal: 12, paddingVertical: 6, borderRadius: 16, borderWidth: 1, borderColor: 'rgba(255,255,255,0.2)' },
  danmakuText: { color: 'white', fontWeight: 'bold', fontSize: 12 },

  heroContent: { position: 'absolute', bottom: 0, width: '100%', padding: 20, alignItems: 'center' },
  featuredTag: { color: COLORS.primary, fontWeight: '900', fontSize: 10, letterSpacing: 2, marginBottom: 8 },
  heroTitle: { color: 'white', fontSize: 42, fontWeight: '900', fontStyle: 'italic', textAlign: 'center', marginBottom: 8 },
  heroMeta: { flexDirection: 'row', gap: 10, marginBottom: 20 },
  matchTag: { color: '#4ADE80', backgroundColor: 'rgba(74, 222, 128, 0.2)', paddingHorizontal: 8, paddingVertical: 2, borderRadius: 4, fontSize: 10, fontWeight: 'bold' },
  genreTag: { color: '#60A5FA', backgroundColor: 'rgba(96, 165, 250, 0.2)', paddingHorizontal: 8, paddingVertical: 2, borderRadius: 4, fontSize: 10, fontWeight: 'bold' },

  heroActions: { flexDirection: 'row', gap: 12, width: '100%', marginBottom: 24 },
  playButton: { flex: 1, backgroundColor: 'white', flexDirection: 'row', justifyContent: 'center', alignItems: 'center', padding: 14, borderRadius: 8, gap: 8 },
  playText: { color: 'black', fontWeight: '900' },
  addButton: { width: 50, backgroundColor: '#333', justifyContent: 'center', alignItems: 'center', borderRadius: 8 },

  creatorRow: { width: '100%', paddingLeft: 10 },
  addCreator: { alignItems: 'center', marginRight: 16, width: 60 },
  addCreatorCircle: { width: 56, height: 56, borderRadius: 28, borderWidth: 2, borderColor: '#333', justifyContent: 'center', alignItems: 'center', borderStyle: 'dashed' },
  creatorItem: { alignItems: 'center', marginRight: 16, width: 60 },
  avatar: { width: 56, height: 56, borderRadius: 28, borderWidth: 2 },
  netBorder: { borderColor: COLORS.gold },
  creBorder: { borderColor: COLORS.primary },
  creatorName: { color: 'white', fontSize: 10, marginTop: 4 },

  // Sections
  section: { padding: 20 },
  sectionHeader: { flexDirection: 'row', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12 },
  sectionTitle: { color: 'white', fontSize: 18, fontWeight: 'bold' },
  seeAll: { color: '#666', fontSize: 12 },
  projectCard: { marginRight: 16, width: 140 },
  projectImg: { width: 140, height: 200, borderRadius: 8, backgroundColor: '#333' },
  projectTitle: { color: 'white', fontSize: 12, fontWeight: 'bold', marginTop: 8 },
  projectSub: { color: '#666', fontSize: 10 },
  progressBarBg: { height: 2, backgroundColor: '#333', marginTop: -2, width: '100%' },
  progressBarFill: { height: 2, backgroundColor: 'red' },

  // Profile
  profileHeader: { alignItems: 'center', padding: 20 },
  largeAvatarContainer: { padding: 4, borderRadius: 100, borderWidth: 2, marginBottom: 15, position: 'relative' },
  largeAvatar: { width: 100, height: 100, borderRadius: 50, backgroundColor: '#333' },
  foundingBadge: { position: 'absolute', bottom: -10, alignSelf: 'center', backgroundColor: '#1e293b', paddingHorizontal: 10, paddingVertical: 2, borderRadius: 10, borderWidth: 1, borderColor: '#475569' },
  badgeText: { color: 'white', fontSize: 8, fontWeight: '900' },
  profileName: { color: 'white', fontSize: 24, fontWeight: 'bold', marginBottom: 4 },
  roleRow: { flexDirection: 'row', gap: 4, alignItems: 'center', marginBottom: 20 },
  roleText: { color: '#888', fontSize: 12 },
  statsRow: { flexDirection: 'row', justifyContent: 'space-around', width: '100%', marginBottom: 24, borderTopWidth: 1, borderBottomWidth: 1, borderColor: '#222', paddingVertical: 15 },
  stat: { alignItems: 'center' },
  statNum: { color: 'white', fontSize: 20, fontWeight: '900' },
  statLabel: { color: '#666', fontSize: 10, letterSpacing: 1, marginTop: 2 },
  subButtonProfile: { width: '100%', backgroundColor: COLORS.gold, padding: 14, borderRadius: 8, alignItems: 'center' },
  subButtonTextBlack: { color: 'black', fontWeight: '900' },

  // Modal
  modalOverlay: { flex: 1, backgroundColor: 'rgba(0,0,0,0.9)', justifyContent: 'center', padding: 20 },
  modalContent: { backgroundColor: '#111', borderRadius: 20, padding: 20, borderTopWidth: 1, borderColor: '#333' },
  modalHeader: { flexDirection: 'row', justifyContent: 'space-between', marginBottom: 20 },
  modalTitle: { color: 'white', fontSize: 20, fontWeight: 'bold' },
  subCard: { borderRadius: 12, padding: 20, flexDirection: 'row', gap: 15, alignItems: 'center', marginBottom: 20, borderWidth: 1, borderColor: 'rgba(147, 51, 234, 0.5)' },
  subIcon: { width: 40, height: 40, borderRadius: 20, backgroundColor: 'white', justifyContent: 'center', alignItems: 'center' },
  subIconText: { color: 'black', fontWeight: '900' },
  subCardTitle: { color: 'white', fontWeight: 'bold', fontSize: 16 },
  subCardDesc: { color: '#ccc', fontSize: 12 },
  subButton: { width: '100%', backgroundColor: 'white', padding: 15, borderRadius: 10, alignItems: 'center' },
  subButtonText: { color: 'black', fontWeight: '900', fontSize: 16 },

  // Tab Bar
  tabBar: { backgroundColor: COLORS.black, borderTopColor: '#333', height: 90, paddingBottom: 30, paddingTop: 10 },

  // Messaging Modal
  msgContainer: { flex: 1, backgroundColor: COLORS.black },
  msgHeader: { flexDirection: 'row', justifyContent: 'space-between', alignItems: 'center', padding: 20, borderBottomWidth: 1, borderBottomColor: '#333' },
  msgTitle: { color: 'white', fontSize: 20, fontWeight: 'bold' },
  msgList: { flex: 1 },
  msgRow: { flexDirection: 'row', padding: 16, borderBottomWidth: 1, borderBottomColor: '#222' },
  msgAvatar: { width: 50, height: 50, borderRadius: 25, marginRight: 12 },
  msgContent: { flex: 1 },
  msgTop: { flexDirection: 'row', justifyContent: 'space-between', marginBottom: 4 },
  msgName: { color: 'white', fontWeight: 'bold', fontSize: 16 },
  msgTime: { color: '#666', fontSize: 12 },
  msgPreview: { color: '#999', fontSize: 14 },

  // Empty State
  emptyState: {
    padding: 40,
    alignItems: 'center',
  },
  emptyText: {
    color: '#666',
    fontSize: 14,
  },
});
